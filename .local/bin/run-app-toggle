#!/bin/sh

usage() {
  echo "usage: $(basename $0) [-h] [-P] command"
  exit $1
}

parent=0
[ "$1" = "-h" ] && usage
[ -z "$1" ] && usage 1
[ "$1" = "-P" ] && parent=1 && shift

cmd=$1

if [ $parent = 0 ]; then
  pgrep -u $LOGNAME -x -- $cmd && \
    pkill -u $LOGNAME -x -- $cmd || \
    $* &
else
  p=$(pgrep -u $LOGNAME -x -- $cmd) && \
    pkill -u $LOGNAME -P $p || \
    $* &
fi
