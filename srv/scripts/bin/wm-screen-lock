#!/usr/bin/env bash

forget_ssh=1
forget_bitwarden=1
forget_rbw=1
pause_players=1
mute_speakers=1
mute_mic=1
stop_idle_inhibitor=1
locker="swaylock -f"

[ -r $HOME/.config/screenlockrc ] && source $HOME/.config/screenlockrc

pgrep -u $LOGNAME -f -- "$locker" && exit

# Prep for locking
[ $stop_idle_inhibitor = 1 ] && wm-toggle-idle-inhibit stop
[ $forget_ssh = 1 ]          && ssh-add -D
[ $forget_bitwarden = 1 ]    && keyctl purge user bw_session
[ $forget_rbw = 1 ]          && rbw lock
[ $pause_players = 1 ]       && [ "$(playerctl -a status 2> /dev/null)" = "Playing" ] && playerctl -a pause
[ $mute_speakers = 1 ]       && speaker-mute
[ $mute_mic = 1 ]            && mic-mute

# Lock screen
setsid $locker
